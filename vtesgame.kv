#:kivy 1.7.0
#
GameWidget:

<PlayerSelectWidget>:
    input_area: input
    start_button: start
    Label:
        top: root.height
        center_x: root.width // 2
        text: "Setup the game"
    FloatLayout:
        id: input
        # We'll fill this in dynamically, so we keep references
        # to the text input fields easily
        y: 80
        height: root.height - 160
        width: root.width
    Button:
        id: start
        # Widget subclass, so we fake relative positioning
        size: 0.25 * root.width, 0.05 * root.height
        top: self.height
        x: 0
        text: "Start"
        on_release: root.start()
    Button:
        size: 0.25 * root.width, 0.05 * root.height
        top: self.height
        right: root.width
        text: "Exit"
        on_release: app.stop()


<MinionRow@BoxLayout>:
    name: name
    torpor: torpor
    size_hint: 1, 0.075
    Label:
        id: name
        size_hint: 0.4, 1
        text: ''
        pos_hint: {'x': 0, 'top': 0}
    Button:
        size_hint: 0.2, 1
        text: 'Burn / remove'
        pos_hint: {'x': 0.4, 'top': 0}
        on_release: root.burn()
    Button:
        id: torpor
        size_hint: 0.2, 1
        text: 'Topor'
        pos_hint: {'x': 0.6, 'top': 0}
        on_release: root.do_torpor()
    Button:
        size_hint: 0.2, 1
        text: 'Act'
        pos_hint: {'x': 0.8, 'top': 0}
        on_release: root.other()


<MasterRow@BoxLayout>:
    name: name
    Label:
        id: name
        size: 200, 30
        text: ''
        pos_hint: {'x': 0, 'top': 0.3}


<PlayerScreen@RelativeLayout>:
    game: game
    player: player
    BoxLayout:
        id: player
        size: root.width, 0.1 * root.height
        size_hint: None, None
        pos_hint: {'top': 1}
    ScrollView:
        size: root.width, 0.75 * root.height
        size_hint: None, None
        pos_hint: {'right': 1, 'top': 0.9}
        RelativeLayout:
            id: game
            # We'll fill this in dynamically, so we keep references
            # to the text input fields easily
            size: root.width, 2*root.height
            size_hint: None, None
            Button:
                size_hint: 0.25, 0.02
                pos_hint: {'right': 1, 'top': 1}
                text: "Pool +"
                on_release: root.change_pool(+1)
            Button:
                size_hint: 0.25, 0.02
                pos_hint: {'right': 0.2, 'top': 1}
                text: "Pool -"
                on_release: root.change_pool(-1)
            Button:
                size_hint: 0.25, 0.025
                pos_hint: {'x': 0, 'top': 0.975}
                text: "Add Master"
                on_release: root.add_master()
            Button:
                size_hint: 0.25, 0.025
                pos_hint: {'x': 0.3, 'top': 0.975}
                text: "Add Minion"
                on_release: root.ask_minion_name()
    Button:
        size_hint: 0.25, 0.05
        pos_hint: {'x': 0, 'top': 0.15}
        text: "Prev Player <--"
        on_release: root.change(-1)
    Button:
        size_hint: 0.25, 0.05
        pos_hint: {'right': 1, 'top': 0.15}
        text: "Next Player -->"
        on_release: root.change(+1)
    Button:
        size_hint: 0.2, 0.05
        pos_hint: {'x': 0}
        text: "Next Turn"
        on_release: root.next_turn()
    Button:
        size_hint: 0.2, 0.05
        pos_hint: {'x': 0.25}
        text: "Oust Player"
        on_release: root.oust()
    Button:
        size_hint: 0.2, 0.05
        pos_hint: {'x': 0.55}
        text: "Update Decks"
        on_release: root.update_decks()
    Button:
        size_hint: 0.2, 0.05
        pos_hint: {'right': 1}
        text: "Stop Game"
        on_release: root.stop_game()


<MinionName@Popup>:
    name: name
    size_hint: .6, .6
    auto_dismiss: False
    title: 'Minion Name'
    BoxLayout:
        orientation: 'vertical'
        TextInput:
            id: name
            size_hint: 1, None
        Button:
            size_hint: 0.5, 0.2
            pos_hint: {'top': 0.1}
            text: 'Done'
            on_release: root.done()
